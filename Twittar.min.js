/* https://github.com/FashodaDrummer/twittar */
var Twittar=new Class({Implements:[Options,Events],initialize:function(a,b,c){this.setOptions(c);this.username=a;this.element=$(b);this.url=this.formatUrl();this.request=new Request.JSONP({url:this.url,method:"get",timeout:5E3,onRequest:function(){this.fireEvent("request",[this.element])}.bind(this),onTimeout:function(){this.fireEvent("timeout",[this.element])}.bind(this),onComplete:this.buildTweets.bind(this)})},options:{twitterUrl:"https://api.twitter.com/1/statuses/user_timeline.json?&exclude_replies={replies}&contributor_details={contributerDetails}&include_rts={retweets}&screen_name={username}&count={count}",
showRetweets:true,showReplies:true,contributerDetails:false,tweetCount:5,showUserInfo:true,userInfoElement:"a",onComplete:function(a,b){a.grab(b)}},formatUrl:function(){var a=this.options;return a.twitterUrl.substitute({retweets:a.showRetweets,replies:a.showReplies,count:a.tweetCount,contributerDetails:a.contributerDetails,username:this.username})},linkify:function(a){return a.replace(/(https?:\/\/\S+)/gi,'<a href="$1">$1</a>').replace(/(^|\s)@(\w+)/g,'$1<a href="http://twitter.com/$2">@$2</a>').replace(/(^|\s)#(\w+)/g,
'$1#<a href="http://search.twitter.com/search?q=%23$2">$2</a>')},getTweets:function(){this.request.send();return this},formatTweetDate:function(a){a=a.replace(/^\w+ (\w+) (\d+) ([\d:]+) \+0000 (\d+)$/,"$1 $2 $4 $3 UTC");return(new Date(a)).toUTCString()},formatTweetLink:function(a,b){return"http://twitter.com/{user}/status/{id}".substitute({user:a,id:b})},buildTweets:function(a){if(a.length!=0){var b=new Element("ul"),c=new Element("div",{"class":"tweets"});this.options.showUserInfo&&c.grab(new Element(this.options.userInfoElement,
{"class":"twitter-user",text:"@"+a[0].user.screen_name,href:"http://twitter.com/"+a[0].user.screen_name}),"top");Object.each(a,function(a){var d=new Element("li",{"class":"tweet"}),e=new Element("span",{"class":"tweet-text",html:this.linkify(a.text)}),a=new Element("a",{"class":"tweet-date",text:this.formatTweetDate(a.created_at),href:this.formatTweetLink(a.user.screen_name,a.id_str)});d.grab(e).grab(a).inject(b);b.inject(c)},this);this.fireEvent("complete",[this.element,c,b,b.getChildren(),a])}}});